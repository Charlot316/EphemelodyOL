(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-039f1028"],{3530:function(e,t,n){"use strict";n.r(t);var a=n("7a23"),l=Object(a["fb"])("data-v-5827fc0e");Object(a["H"])("data-v-5827fc0e");var o={style:{width:"100%",height:"100%"}},r={class:"div1"},c={class:"divTop"},u={style:{float:"right",width:"70%"}},i={class:"div3"},s={class:"div6"},d={style:{display:"flex","justify-content":"space-between","align-items":"center"}},f={class:"div7"},b={class:"div8"},m={class:"icon-active",icon:"el-icon-link",style:{"margin-left":"10px",cursor:"pointer"}},p={class:"icon-active",icon:"el-icon-link",style:{"margin-left":"10px",cursor:"pointer"}},g={class:"div9"},h={class:"div9"},j={class:"div9"},O={class:"div9"},v=Object(a["m"])("上传音频"),w=Object(a["m"])("上传歌曲默认背景"),V=Object(a["m"])("上传歌曲封面"),y={class:"dialog-footer"},k=Object(a["m"])("取 消"),S=Object(a["m"])("确 定"),C={class:"dialog-footer"},U=Object(a["m"])("取 消"),_=Object(a["m"])("确 定"),x={key:1,class:"el-icon-plus avatar-uploader-icon"},I=Object(a["n"])("i",{class:"el-icon-plus avatar-uploader-icon"},null,-1),W=Object(a["n"])("i",{class:"el-icon-plus avatar-uploader-icon"},null,-1);Object(a["F"])();var L=l((function(e,t,n,L,A,N){var T=Object(a["N"])("background-display"),$=Object(a["N"])("Header"),R=Object(a["N"])("el-option"),B=Object(a["N"])("el-select"),E=Object(a["N"])("el-col"),M=Object(a["N"])("el-button"),z=Object(a["N"])("el-input"),J=Object(a["N"])("el-row"),F=Object(a["N"])("el-image"),D=Object(a["N"])("el-switch"),H=Object(a["N"])("el-form-item"),q=Object(a["N"])("el-form"),K=Object(a["N"])("el-dialog"),P=Object(a["N"])("el-upload");return Object(a["E"])(),Object(a["j"])("div",o,[Object(a["n"])(T),Object(a["n"])("div",r,[Object(a["n"])($),Object(a["n"])("div",c,[Object(a["n"])("button",{class:"btn btn1",onClick:t[1]||(t[1]=function(e){return N.getAdd()})},"新增"),Object(a["n"])("div",u,[Object(a["n"])(J,null,{default:l((function(){return[Object(a["n"])(E,{span:6},{default:l((function(){return[Object(a["n"])(B,{modelValue:A.params.searchType,"onUpdate:modelValue":t[2]||(t[2]=function(e){return A.params.searchType=e}),placeholder:"搜索类别",size:"medium",class:"handle-select mr10",id:"搜索类别"},{default:l((function(){return[Object(a["n"])(R,{key:"0",label:"歌曲名称",value:"0"}),Object(a["n"])(R,{key:"1",label:"歌手名称",value:"1"}),Object(a["n"])(R,{key:"2",label:"上传者名称",value:"2"}),Object(a["n"])(R,{key:"3",label:"难度",value:"3"}),Object(a["n"])(R,{key:"4",label:"热度",value:"4"})]})),_:1},8,["modelValue"])]})),_:1}),Object(a["n"])(E,{span:1}),Object(a["n"])(E,{span:11},{default:l((function(){return[Object(a["n"])(z,{placeholder:"请输入关键词进行搜索",modelValue:A.params.searchContent,"onUpdate:modelValue":t[4]||(t[4]=function(e){return A.params.searchContent=e}),size:"medium",onKeyup:t[5]||(t[5]=Object(a["db"])((function(e){return N.getCharts()}),["enter"]))},{append:l((function(){return[Object(a["n"])(M,{icon:"el-icon-search",onClick:t[3]||(t[3]=function(e){return N.getCharts()}),type:"primary"})]})),_:1},8,["modelValue"])]})),_:1}),Object(a["n"])(E,{span:1}),Object(a["n"])(E,{span:5},{default:l((function(){return[Object(a["n"])(B,{modelValue:A.sort,"onUpdate:modelValue":t[6]||(t[6]=function(e){return A.sort=e}),placeholder:"按歌手名升序",size:"medium",class:"handle-select mr10",id:"升/降",onChange:t[7]||(t[7]=function(e){return N.getCharts()})},{default:l((function(){return[Object(a["n"])(R,{key:"0",label:"按歌曲名升序",value:"00"}),Object(a["n"])(R,{key:"1",label:"按歌曲名降序",value:"01"}),Object(a["n"])(R,{key:"2",label:"按歌手名升序",value:"10"}),Object(a["n"])(R,{key:"3",label:"按歌手名降序",value:"11"}),Object(a["n"])(R,{key:"4",label:"按上传者名升序",value:"20"}),Object(a["n"])(R,{key:"5",label:"按歌手名降序",value:"21"}),Object(a["n"])(R,{key:"6",label:"按难度升序",value:"30"}),Object(a["n"])(R,{key:"7",label:"按难度降序",value:"31"}),Object(a["n"])(R,{key:"8",label:"按热度升序",value:"40"}),Object(a["n"])(R,{key:"9",label:"按热度降序",value:"41"})]})),_:1},8,["modelValue"])]})),_:1})]})),_:1})])]),Object(a["n"])("div",i,[(Object(a["E"])(!0),Object(a["j"])(a["b"],null,Object(a["L"])(A.songs,(function(e){return Object(a["E"])(),Object(a["j"])("div",{class:"div4",key:e},[Object(a["n"])("div",{class:"div5",onClick:function(t){return N.next(e.songId)}},[Object(a["n"])(F,{src:e.songCover,class:"img1"},null,8,["src"])],8,["onClick"]),Object(a["n"])("div",s,[Object(a["n"])("div",d,[Object(a["n"])("div",f,Object(a["R"])(e.songName),1),Object(a["n"])("div",b,[Object(a["n"])("span",m,[Object(a["n"])("i",{class:"el-icon-setting",onClick:function(t){return N.getEdit(e.songId,e)}},null,8,["onClick"])]),Object(a["n"])("span",p,[Object(a["n"])("i",{class:"el-icon-delete",onClick:function(t){return N.deleteSong(e.songId)}},null,8,["onClick"])])])]),Object(a["n"])("div",g,[Object(a["n"])("span",null,"作者："+Object(a["R"])(e.songWriter),1)]),Object(a["n"])("div",h,"谱面定数："+Object(a["R"])(e.chartConstant),1),Object(a["n"])("div",j,"加载中文字："+Object(a["R"])(e.loadingText),1),Object(a["n"])("div",O,"加载完成文字："+Object(a["R"])(e.loadedText),1)])])})),128))]),Object(a["n"])(K,{title:"修改谱面信息",modelValue:A.editVisible,"onUpdate:modelValue":t[19]||(t[19]=function(e){return A.editVisible=e}),width:"40%"},{footer:l((function(){return[Object(a["n"])("div",y,[Object(a["n"])(M,{onClick:t[17]||(t[17]=function(e){return A.editVisible=!1})},{default:l((function(){return[k]})),_:1}),Object(a["n"])(M,{type:"primary",onClick:t[18]||(t[18]=function(e){return N.editSongInfo()})},{default:l((function(){return[S]})),_:1})])]})),default:l((function(){return[Object(a["n"])(q,{model:A.form},{default:l((function(){return[Object(a["n"])(H,{label:"是否公开谱面","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(D,{modelValue:A.value,"onUpdate:modelValue":t[8]||(t[8]=function(e){return A.value=e}),"active-color":"#13ce66","active-value":!0,disabled:N.getStatus()},null,8,["modelValue","disabled"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"歌曲名称","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.form.songName,"onUpdate:modelValue":t[9]||(t[9]=function(e){return A.form.songName=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"歌手名称","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.form.songWriter,"onUpdate:modelValue":t[10]||(t[10]=function(e){return A.form.songWriter=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{"label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(M,{type:"primary",size:"small",onClick:t[11]||(t[11]=function(e){return N.startUploadSong()})},{default:l((function(){return[v]})),_:1})]})),_:1},8,["label-width"]),Object(a["n"])(H,{"label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(M,{type:"primary",size:"small",onClick:t[12]||(t[12]=function(e){return N.startUploadBack()})},{default:l((function(){return[w]})),_:1})]})),_:1},8,["label-width"]),Object(a["n"])(H,{"label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(M,{type:"primary",size:"small",onClick:t[13]||(t[13]=function(e){return N.startUploadCover()})},{default:l((function(){return[V]})),_:1})]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"设置加载文字","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.form.loadingText,"onUpdate:modelValue":t[14]||(t[14]=function(e){return A.form.loadingText=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"设置谱面定数","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.form.chartConstant,"onUpdate:modelValue":t[15]||(t[15]=function(e){return A.form.chartConstant=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"设置加载完毕文字","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.form.loadedText,"onUpdate:modelValue":t[16]||(t[16]=function(e){return A.form.loadedText=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"])]})),_:1},8,["model"])]})),_:1},8,["modelValue"]),Object(a["n"])(K,{title:"新增谱面",modelValue:A.addVisible,"onUpdate:modelValue":t[29]||(t[29]=function(e){return A.addVisible=e}),width:"40%"},{footer:l((function(){return[Object(a["n"])("div",C,[Object(a["n"])(M,{onClick:t[27]||(t[27]=function(e){return A.addVisible=!1})},{default:l((function(){return[U]})),_:1}),Object(a["n"])(M,{type:"primary",onClick:t[28]||(t[28]=function(e){return N.addSong()})},{default:l((function(){return[_]})),_:1})])]})),default:l((function(){return[Object(a["n"])(q,{model:A.newSong},{default:l((function(){return[Object(a["n"])(H,{label:"默认背景","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.newSong.defaultBackground,"onUpdate:modelValue":t[20]||(t[20]=function(e){return A.newSong.defaultBackground=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"歌曲音频","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.newSong.songUrl,"onUpdate:modelValue":t[21]||(t[21]=function(e){return A.newSong.songUrl=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"作者","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.newSong.songWriter,"onUpdate:modelValue":t[22]||(t[22]=function(e){return A.newSong.songWriter=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"封面","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.newSong.songCover,"onUpdate:modelValue":t[23]||(t[23]=function(e){return A.newSong.songCover=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"加载文字","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.newSong.loadingText,"onUpdate:modelValue":t[24]||(t[24]=function(e){return A.newSong.loadingText=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"加载完成文字","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.newSong.loadedText,"onUpdate:modelValue":t[25]||(t[25]=function(e){return A.newSong.loadedText=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"]),Object(a["n"])(H,{label:"歌曲名称","label-width":A.formLabelWidth},{default:l((function(){return[Object(a["n"])(z,{modelValue:A.newSong.songName,"onUpdate:modelValue":t[26]||(t[26]=function(e){return A.newSong.songName=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["label-width"])]})),_:1},8,["model"])]})),_:1},8,["modelValue"]),Object(a["n"])(K,{title:"上传音频",modelValue:A.uploadSongVisible,"onUpdate:modelValue":t[30]||(t[30]=function(e){return A.uploadSongVisible=e}),width:"20%"},{default:l((function(){return[Object(a["n"])(P,{class:"avatar-uploader",action:"http://47.113.89.104:8090/chart/uploadSong","with-credentials":"true",name:"file",accept:".wav,.mp4","auto-upload":"false",data:{songId:A.selectedSongId},"show-file-list":!1,"on-success":N.handleAvatarSuccess1,"before-upload":e.beforeAvatarUpload},{default:l((function(){return[A.songUrl?(Object(a["E"])(),Object(a["j"])("img",{key:0,src:A.songUrl,class:"avatar"},null,8,["src"])):(Object(a["E"])(),Object(a["j"])("i",x))]})),_:1},8,["data","on-success","before-upload"])]})),_:1},8,["modelValue"]),Object(a["n"])(K,{title:"上传默认背景",modelValue:A.uploadBackVisible,"onUpdate:modelValue":t[31]||(t[31]=function(e){return A.uploadBackVisible=e}),width:"20%"},{default:l((function(){return[Object(a["n"])(P,{class:"avatar-uploader",action:"http://47.113.89.104:8090/chart/uploadDefaultBackground","with-credentials":"true",name:"file",accept:".jpg,.png","auto-upload":"false",data:{songId:A.selectedSongId},"show-file-list":!1,"on-success":N.handleAvatarSuccess2,"before-upload":e.beforeAvatarUpload},{default:l((function(){return[I]})),_:1},8,["data","on-success","before-upload"])]})),_:1},8,["modelValue"]),Object(a["n"])(K,{title:"上传歌曲封面",modelValue:A.uploadCoverVisible,"onUpdate:modelValue":t[32]||(t[32]=function(e){return A.uploadCoverVisible=e}),width:"20%"},{default:l((function(){return[Object(a["n"])(P,{class:"avatar-uploader",action:"http://47.113.89.104:8090/chart/uploadSongCover","with-credentials":"true",name:"file",accept:".jpg,.png","auto-upload":"false",data:{songId:A.selectedSongId},"show-file-list":!1,"on-success":N.handleAvatarSuccess3,"before-upload":e.beforeAvatarUpload},{default:l((function(){return[W]})),_:1},8,["data","on-success","before-upload"])]})),_:1},8,["modelValue"])])])})),A=n("1da1"),N=(n("7db0"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("96cf"),n("6a43")),T=n("0418"),$={components:{BackgroundDisplay:N["a"],Header:T["a"]},data:function(){return{type:"",sort:"",params:{status:"0",searchType:"",searchContent:"",sortType:"",sortWay:""},form:{songId:"",songName:"",songWriter:"",songUrl:"",defaultBackground:"",songCover:"",loadingText:"",chartConstant:"",loadedText:""},newSong:{BPM:"",firstBeatDelay:"",songId:"",songLength:"",defaultBackground:"",songUrl:"",uploader:"",songWriter:"",songCover:"",loadingText:"",loadedText:"",songName:"",notesCount:"",uploaderId:""},deleteForm:{songId:""},songs:[],editVisible:!1,selectedSongId:"",selectedSong:"",addVisible:!1,value:!0,song:{songId:""},uploadSongVisible:!1,uploadBackVisible:!1,uploadCoverVisible:!1,songUrl:"",formLabelWidth:"100"}},mounted:function(){},created:function(){this.getMyAllCharts()},methods:{getMyAllCharts:function(){var e=this;return Object(A["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/user/getAllMyCharts");case 2:n=t.sent,a=n.data,0==a.code?e.songs=a.data.charts:e.$message.error("获取异常");case 5:case"end":return t.stop()}}),t)})))()},getCharts:function(){var e=this;return Object(A["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.sortType=e.sort.substr(0,1),e.params.sortWay=e.sort.substr(1,1),t.next=4,e.$http.post("/user/getMyCharts",e.params);case 4:n=t.sent,a=n.data,0==a.code?e.songs=a.data.charts:e.$message.error("获取异常");case 7:case"end":return t.stop()}}),t)})))()},getEdit:function(e,t){this.selectedSongId=e,this.selectedSong=t,this.getValue(),console.log(this.value),this.form=JSON.parse(JSON.stringify(this.songs.find((function(t){return t.songId==e})))),console.log(JSON.stringify(this.form)),this.editVisible=!0},getStatus:function(){return 0!=this.selectedSong.status&&1!=this.selectedSong.status},getValue:function(){0==this.selectedSong.status?this.value=!1:this.value=!0},getAdd:function(){this.addVisible=!0},startUploadSong:function(){this.uploadSongVisible=!0},startUploadBack:function(){this.uploadBackVisible=!0},startUploadCover:function(){this.uploadCoverVisible=!0},addSong:function(){var e=this;return Object(A["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/chart/newChart",e.newSong);case 2:n=t.sent,a=n.data,0===a.code?(e.$message.success("新增成功"),e.getMyAllCharts(),e.addVisible=!1):e.$message.error("编辑失败");case 5:case"end":return t.stop()}}),t)})))()},editSongInfo:function(){var e=this;return Object(A["a"])(regeneratorRuntime.mark((function t(){var n,a,l,o,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(e.form),e.song.songId=e.selectedSongId,e.form.songId=e.selectedSongId,!e.value||e.getStatus()){t.next=9;break}return t.next=6,e.$http.post("/user/publiciseChart",e.song);case 6:n=t.sent,a=n.data,0!=a.code&&e.$message.error("公开化失败");case 9:if(e.value||e.getStatus()){t.next=15;break}return t.next=12,e.$http.post("/user/privatizeChart",e.song);case 12:l=t.sent,o=l.data,0!=o.code&&e.$message.error("取消公开化失败");case 15:return t.next=17,e.$http.post("/chart/editChartInfo",e.form);case 17:r=t.sent,c=r.data,0==c.code?(e.$message.success("修改成功"),e.getMyAllCharts(),e.editVisible=!1):e.$message.error("编辑失败");case 20:case"end":return t.stop()}}),t)})))()},delete:function(e){var t=this;return Object(A["a"])(regeneratorRuntime.mark((function n(){var a,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.deleteForm.songId=e,n.next=3,t.$http.post("/user/deleteChart",t.deleteForm);case 3:a=n.sent,l=a.data,0===l.code?(t.getMyAllCharts(),t.$message({type:"success",message:"删除成功!"})):t.$message({type:"error",message:"删除失败!"});case 6:case"end":return n.stop()}}),n)})))()},deleteSong:function(e){var t=this;this.$confirm("此操作删除该谱面, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.delete(e)}))},next:function(e){this.$router.push({path:"/chart/maker",query:{songId:e}}),setTimeout((function(){location.reload()}),100)},handleAvatarSuccess1:function(e,t){this.songUrl=URL.createObjectURL(t.raw),this.$message.success("上传成功"),console.log(e),this.form.songUrl=e.data,this.uploadSongVisible=!1},handleAvatarSuccess2:function(e,t){this.songUrl=URL.createObjectURL(t.raw),this.$message.success("上传成功"),this.form.defaultBackground=e.data.url,this.uploadBackVisible=!1},handleAvatarSuccess3:function(e,t){this.songUrl=URL.createObjectURL(t.raw),this.$message.success("上传成功"),this.form.songCover=e.data.url,this.uploadCoverVisible=!1}}},R=(n("3688"),n("d959")),B=n.n(R);const E=B()($,[["render",L],["__scopeId","data-v-5827fc0e"]]);t["default"]=E},3688:function(e,t,n){"use strict";n("6a53")},"65f0":function(e,t,n){var a=n("861d"),l=n("e8b5"),o=n("b622"),r=o("species");e.exports=function(e,t){var n;return l(e)&&(n=e.constructor,"function"!=typeof n||n!==Array&&!l(n.prototype)?a(n)&&(n=n[r],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},"6a53":function(e,t,n){},"7db0":function(e,t,n){"use strict";var a=n("23e7"),l=n("b727").find,o=n("44d2"),r="find",c=!0;r in[]&&Array(1)[r]((function(){c=!1})),a({target:"Array",proto:!0,forced:c},{find:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}}),o(r)},b727:function(e,t,n){var a=n("0366"),l=n("44ad"),o=n("7b0b"),r=n("50c4"),c=n("65f0"),u=[].push,i=function(e){var t=1==e,n=2==e,i=3==e,s=4==e,d=6==e,f=7==e,b=5==e||d;return function(m,p,g,h){for(var j,O,v=o(m),w=l(v),V=a(p,g,3),y=r(w.length),k=0,S=h||c,C=t?S(m,y):n||f?S(m,0):void 0;y>k;k++)if((b||k in w)&&(j=w[k],O=V(j,k,v),e))if(t)C[k]=O;else if(O)switch(e){case 3:return!0;case 5:return j;case 6:return k;case 2:u.call(C,j)}else switch(e){case 4:return!1;case 7:u.call(C,j)}return d?-1:i||s?s:C}};e.exports={forEach:i(0),map:i(1),filter:i(2),some:i(3),every:i(4),find:i(5),findIndex:i(6),filterOut:i(7)}},e8b5:function(e,t,n){var a=n("c6b6");e.exports=Array.isArray||function(e){return"Array"==a(e)}}}]);
//# sourceMappingURL=chunk-039f1028.10f77705.js.map