(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0bfa384c"],{"004d":function(t,e,a){"use strict";a("48aa")},"0ccb":function(t,e,a){var n=a("50c4"),o=a("1148"),i=a("1d80"),r=Math.ceil,s=function(t){return function(e,a,s){var l,c,u=String(i(e)),d=u.length,g=void 0===s?" ":String(s),h=n(a);return h<=d||""==g?u:(l=h-d,c=o.call(g,r(l/g.length)),c.length>l&&(c=c.slice(0,l)),t?u+c:c+u)}};t.exports={start:s(!1),end:s(!0)}},"1e43":function(t,e,a){"use strict";a("28e1")},"28e1":function(t,e,a){},"48aa":function(t,e,a){},"4d90":function(t,e,a){"use strict";var n=a("23e7"),o=a("0ccb").start,i=a("9a0c");n({target:"String",proto:!0,forced:i},{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},"8f2e":function(t,e,a){"use strict";a.r(e);var n=a("7a23"),o=Object(n["fb"])("data-v-d81e6c60");Object(n["H"])("data-v-d81e6c60");var i={class:"play-interface select",id:"play-interface-container"},r={style:{"text-align":"center"}};Object(n["F"])();var s=o((function(t,e,a,s,l,c){var u=Object(n["N"])("Prepare"),d=Object(n["N"])("Play"),g=Object(n["N"])("Result"),h=Object(n["N"])("el-button"),b=Object(n["N"])("el-dialog");return Object(n["E"])(),Object(n["j"])("div",i,[Object(n["n"])(u,{loadingStatus:l.loadingStatus,chart:l.chart,onStartMusic:c.startMusic},null,8,["loadingStatus","chart","onStartMusic"]),Object(n["n"])(d,{loadingStatus:l.loadingStatus,chart:l.chart,global:l.global,imagePath:l.imagePath,whiteLineLength:c.whiteLineLength,score:c.score,onAudioLoaded:c.audioLoaded,onImageLoaded:c.imageLoaded,onAddCount:c.addCount,onPause:c.pause,onRestart:c.reStart,onContinuePlay:c.continuePlay},null,8,["loadingStatus","chart","global","imagePath","whiteLineLength","score","onAudioLoaded","onImageLoaded","onAddCount","onPause","onRestart","onContinuePlay"]),Object(n["n"])(g,{loadingStatus:l.loadingStatus,chart:l.chart,global:l.global},null,8,["loadingStatus","chart","global"]),Object(n["n"])(b,{modelValue:l.pauseVisible,"onUpdate:modelValue":e[2]||(e[2]=function(t){return l.pauseVisible=t}),title:"暂停",top:"30vh",center:!0,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{default:o((function(){return[Object(n["n"])("div",r,[Object(n["n"])(h,{icon:"el-icon-caret-left",onClick:e[1]||(e[1]=function(e){return t.$router.go(-1)}),circle:""}),Object(n["n"])(h,{icon:"el-icon-refresh-left",circle:"",onClick:c.reStart},null,8,["onClick"]),Object(n["n"])(h,{icon:"el-icon-caret-right",circle:"",onClick:c.continuePlay},null,8,["onClick"])])]})),_:1},8,["modelValue"])])})),l=a("1da1"),c=(a("96cf"),a("4d90"),a("d3b7"),a("25f0"),a("38cf"),a("77ed"),Object(n["fb"])("data-v-f136e1e0"));Object(n["H"])("data-v-f136e1e0");var u={key:0,class:"play-interface"},d=Object(n["n"])("canvas",{id:"track-canvas",style:{position:"absolute",top:"0",left:"0"}},null,-1),g=Object(n["n"])("canvas",{id:"note-canvas",style:{position:"absolute",top:"0",left:"0"}},null,-1),h=Object(n["n"])("canvas",{id:"judge-canvas",style:{position:"absolute",top:"0",left:"0"}},null,-1),b={class:"score-counter",style:{"text-align":"center",position:"absolute",right:"0px",width:"200px",margin:"0 auto","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"40px",color:"rgb(255,255,255)"}},p={key:0,class:"combo-counter"},f={style:{"text-align":"center",width:"200px",margin:"0 auto","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"70px",color:"rgb(255,255,255)"}},m={style:{"text-align":"center",width:"200px",margin:"0 auto","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"20px",color:"rgb(255,255,255)"}},j=Object(n["m"])(" COMBO ");Object(n["F"])();var v=c((function(t,e,a,o,i,r){var s=Object(n["N"])("Track");return a.loadingStatus.finished?Object(n["k"])("",!0):Object(n["cb"])((Object(n["E"])(),Object(n["j"])("div",u,[Object(n["n"])("audio",{id:"audioSong",preload:"auto",controls:"",src:a.chart.songUrl,style:{display:"none"},onCanplaythrough:e[1]||(e[1]=function(){return r.audioLoaded&&r.audioLoaded.apply(r,arguments)})},null,40,["src"]),(Object(n["E"])(!0),Object(n["j"])(n["b"],null,Object(n["L"])(a.imagePath,(function(t){return Object(n["E"])(),Object(n["j"])("div",{key:t},[Object(n["cb"])(Object(n["n"])("img",{src:t.url,onLoad:e[2]||(e[2]=function(){return r.imageLoaded&&r.imageLoaded.apply(r,arguments)}),style:{position:"absolute",left:"0",top:"0",width:"100%",height:"100%","object-fit":"fill","user-drag":"none"}},null,40,["src"]),[[n["Y"],a.global.currentTime>=t.startTime&&a.global.currentTime<=t.endTime]])])})),128)),Object(n["n"])("div",{style:{height:"2px",position:"absolute",left:"0px",top:a.global.screenHeight*a.global.finalY-1+"px",width:a.global.screenWidth+"px"}},[Object(n["n"])("div",{class:"white-line",style:{height:"100%",position:"absolute",left:(a.global.screenWidth-a.whiteLineLength)/2+"px",width:a.whiteLineLength+"px",background:"rgba(255,255,255,1)"}},null,4)],4),d,g,h,(Object(n["E"])(!0),Object(n["j"])(n["b"],null,Object(n["L"])(a.chart.tracks,(function(t){return Object(n["E"])(),Object(n["j"])("div",{class:"play-interface-track-container",key:t},[a.global.currentTime>t.startTiming&&a.global.currentTime<t.endTiming?(Object(n["E"])(),Object(n["j"])(s,{key:0,Track:t,global:a.global,onAddCount:r.addCount},null,8,["Track","global","onAddCount"])):Object(n["k"])("",!0)])})),128)),Object(n["n"])("div",{class:a.loadingStatus.beforeFinished?"play-interface-scoreboard-container-upward":"play-interface-scoreboard-container-downward",style:{height:"200px",position:"absolute",left:"0px",width:a.global.screenWidth+"px",background:["-webkit-linear-gradient(90deg, rgba(0,0,0,0) 0, rgba(0,0,0,1) 100%)","-moz-linear-gradient(0deg, rgba(0,0,0,0) 0, rgba(0,0,0,1) 100%)","linear-gradient(0deg, rgba(0,0,0,0) 0, rgba(0,0,0,1) 100%)"]}},[Object(n["n"])("div",{class:"score-counter",style:{"text-align":"center",position:"absolute",left:"0px",width:"50px",margin:"0 auto","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"30px",color:"rgb(255,255,255)",cursor:"pointer"},onClick:e[3]||(e[3]=function(){return r.pause&&r.pause.apply(r,arguments)})},Object(n["R"])("| |")),Object(n["n"])("div",b,Object(n["R"])(a.score),1),a.global.combo>1?(Object(n["E"])(),Object(n["j"])("div",p,[Object(n["n"])("div",f,Object(n["R"])(a.global.combo),1),Object(n["n"])("div",m,[Object(n["n"])("span",{style:{color:[a.global.combo==a.global.pureCount&&0==a.global.lostCount?"rgb(247, 199, 9)":0==a.global.lostCount?"rgb(135, 206, 250)":"rgb(255, 255, 255)"]}},Object(n["R"])(0==a.global.lostCount?"⬥":"⬦"),5),j,Object(n["n"])("span",{style:{color:[a.global.combo==a.global.pureCount&&0==a.global.lostCount?"rgb(247, 199, 9)":0==a.global.lostCount?"rgb(135, 206, 250)":"rgb(255, 255, 255)"]}},Object(n["R"])(0==a.global.lostCount?"⬥":"⬦"),5)])])):Object(n["k"])("",!0)],6)],512)),[[n["Y"],a.loadingStatus.runStart]])})),y=a("49d9"),x={props:["loadingStatus","chart","global","imagePath","score","whiteLineLength"],components:{Track:y["a"]},data:function(){return{}},methods:{audioLoaded:function(){this.$emit("audioLoaded")},imageLoaded:function(){this.$emit("imageLoaded")},pause:function(){this.$emit("pause")},back:function(){this.$emit("back")},reStart:function(){this.$emit("reStart")},continuePlay:function(){this.$emit("continuePlay")},addCount:function(t){this.$emit("addCount",t)}}},O=(a("004d"),a("d959")),k=a.n(O);const C=k()(x,[["render",v],["__scopeId","data-v-f136e1e0"]]);var w=C,T=Object(n["fb"])("data-v-78d5c148");Object(n["H"])("data-v-78d5c148");var S={key:0,class:"show-info"},L=Object(n["n"])("div",{style:{position:"absolute",width:"100vw",height:"100vh"}},null,-1),P={style:{display:"flex","justify-content":"space-between","align-items":"center"}},R={class:"songcover-container"},I={class:"info",style:{padding:"20px"}},E={class:"song-uploader",style:{"text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"30px",color:"rgb(255,250,235)"}},$={class:"song-name",style:{"text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"70px",color:"rgb(255,255,255)","background-color":"rgba(105, 245, 202, 0.5)"}},H={class:"song-writer",style:{"text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"50px",color:"rgb(255,255,255)","background-color":"rgba(255, 255, 255, 0.5)"}},z={class:"loading-container",style:{"text-align":"center","margin-right":"50px"}},W={key:0,class:"loading-text",style:{padding:"10px","min-width":"400px","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"20px",color:"rgb(255,255,255)"}},B={key:1,style:{padding:"10px","min-width":"400px","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"20px",color:"rgb(255,255,255)"}},M={key:2,class:"loaded-text",style:{height:"2px","min-width":"400px","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"20px",color:"rgb(255,255,255)"}};Object(n["F"])();var U=T((function(t,e,a,o,i,r){return a.loadingStatus.runStart?Object(n["k"])("",!0):(Object(n["E"])(),Object(n["j"])("div",S,[Object(n["n"])("img",{src:a.chart.defaultBackground,class:"loading-background",style:{"user-drag":"none"}},null,8,["src"]),L,Object(n["n"])("div",{class:a.loadingStatus.runReady?"info-container-out":"info-container",style:{overflow:"auto"}},[Object(n["n"])("div",P,[Object(n["n"])("div",R,[Object(n["n"])("img",{class:"songcover-img",src:a.chart.songCover},null,8,["src"])]),Object(n["n"])("div",I,[Object(n["n"])("div",E,Object(n["R"])(a.chart.uploader),1),Object(n["n"])("div",$,Object(n["R"])(a.chart.songName),1),Object(n["n"])("div",H,Object(n["R"])(a.chart.songWriter),1)])]),Object(n["n"])("div",z,[Object(n["n"])("div",{class:a.loadingStatus.canRun?"play-button":"play-button-disabled",style:{width:"150px",height:"150px","line-height":"150px",margin:"20px auto","border-radius":"50%"},onClick:e[1]||(e[1]=function(){return r.startMusic&&r.startMusic.apply(r,arguments)})},Object(n["R"])(a.loadingStatus.canRun?"开始":"加载中"),3),a.loadingStatus.canRun?Object(n["k"])("",!0):(Object(n["E"])(),Object(n["j"])("div",W,Object(n["R"])(a.chart.loadingText),1)),a.loadingStatus.canRun?(Object(n["E"])(),Object(n["j"])("div",B,Object(n["R"])(a.chart.loadedText),1)):Object(n["k"])("",!0),a.loadingStatus.canRun?(Object(n["E"])(),Object(n["j"])("div",M)):Object(n["k"])("",!0)])],2)]))})),F={props:["loadingStatus","chart"],components:{},watch:{chart:function(){this.$forceUpdate(),console.log(this.chart.defaultBackground)}},created:function(){},methods:{startMusic:function(){this.$emit("startMusic")}}};a("a43a");const N=k()(F,[["render",U],["__scopeId","data-v-78d5c148"]]);var V=N,_=Object(n["fb"])("data-v-dfef2e50");Object(n["H"])("data-v-dfef2e50");var A={key:0,class:"show-record"},D={class:"loading-background-end"},X={class:"record-container"},Y={class:"song-cover"},q={class:"record-content"},J={class:"song-name",style:{"min-width":"400px","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"50px",color:"rgb(255,255,255)","background-color":"rgba(105, 245, 202, 0.5)",padding:"0px 10px"}},G={style:{"min-width":"400px","text-align":"left","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"70px",color:"rgb(255,255,255)",padding:"0px 10px"}},K={style:{"min-width":"400px","text-align":"left","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"20px",color:"rgb(255,255,255)",padding:"0px 10px"}},Q={style:{"min-width":"400px","text-align":"left","text-shadow":"1px 1px 0 rgba(0,0,0,0.25)","font-size":"20px",color:"rgb(255,255,255)",padding:"0px 10px"}};Object(n["F"])();var Z=_((function(t,e,a,o,i,r){return a.loadingStatus.finished?(Object(n["E"])(),Object(n["j"])("div",A,[Object(n["n"])("div",D,[Object(n["n"])("img",{src:a.chart.defaultBackground,class:"loading-background"},null,8,["src"])]),Object(n["n"])("div",{class:"loading-background-end-shader",style:{position:"absolute",top:0,left:0,height:a.global.screenHeight+"px",width:a.global.screenWidth+"px"}},null,4),Object(n["n"])("div",X,[Object(n["n"])("div",{class:"record-container-body",style:{position:"absolute",top:.2*a.global.screenHeight+"px",left:0,height:.6*a.global.screenHeight+"px",width:"100%"}},[Object(n["n"])("div",Y,[Object(n["n"])("img",{class:"songcover-img",src:a.chart.songCover},null,8,["src"])]),Object(n["n"])("div",q,[Object(n["n"])("div",null,[Object(n["n"])("div",J,Object(n["R"])(a.chart.songName),1),Object(n["n"])("div",G,Object(n["R"])(a.global.score),1),Object(n["n"])("div",K," 最大连击:"+Object(n["R"])(a.global.maxCombo+"　")+"历史最佳成绩:"+Object(n["R"])(a.global.formerBestScore),1),Object(n["n"])("div",Q," pure:"+Object(n["R"])(a.global.pureCount+"　")+"far:"+Object(n["R"])(a.global.farCount+"　")+"lost:"+Object(n["R"])(a.global.lostCount),1)])])],4),Object(n["n"])("div",{class:"play-button",onClick:e[1]||(e[1]=function(e){return t.$router.go(-1)}),style:{width:"150px",height:"150px","line-height":"150px",position:"absolute",bottom:"50px",right:"50px","border-radius":"50%","text-align":"center"}}," 继续 ")])])):Object(n["k"])("",!0)})),tt={props:["loadingStatus","chart","global"]};a("1e43");const et=k()(tt,[["render",Z],["__scopeId","data-v-dfef2e50"]]);var at=et,nt={components:{Play:w,Prepare:V,Result:at},data:function(){return{chart:{songLength:0},global:{},imagePath:[],pauseVisible:!1,audio:null,playInterface:null,chartGot:!1,loadingStatus:{chart:!1,audio:!1,image:!1,canRun:!1,runReady:!1,runStart:!1,beforeFinished:!1,finished:!1,imageCurrentCount:0}}},computed:{whiteLineLength:function(){var t=200,e=1e3;return this.global.currentTime>t+e&&this.global.currentTime<this.chart.songLength-t?this.global.screenWidth:this.global.currentTime<=t+e?this.global.currentTime<e?0:(this.global.currentTime-e)*this.global.screenWidth/t:(this.chart.songLength-this.global.currentTime)*this.global.screenWidth/t},score:function(){return this.global.score?this.global.score.toString().padStart(8,"0"):"00000000"}},watch:{"global.pureCount":function(){this.calculateScore()},"global.farCount":function(){this.calculateScore()}},created:function(){this.loadingStatus={chart:!1,audio:!1,image:!1,canRun:!1,runReady:!1,runStart:!1,beforeFinished:!1,finished:!1,imageCurrentCount:0},this.global={screenWidth:0,screenHeight:0,remainingTime:1e3,finalY:.8,currentTime:0,lostTime:150,pureTime:50,farTime:100,isEdit:!1,keyPressTime:[],keyIsHold:[],keyUsed:[],keyMap:[],pureCount:0,farCount:0,lostCount:0,combo:0,maxCombo:0,score:0,notePainter:null,trackPainter:null,judgePainter:null,noteCanvas:null,trackCanvas:null,judgeCanvas:null,repaint:!1}},mounted:function(){var t=this;this.playInterface=document.getElementById("play-interface-container"),this.global.noteCanvas=document.getElementById("note-canvas"),this.global.trackCanvas=document.getElementById("track-canvas"),this.global.judgeCanvas=document.getElementById("judge-canvas"),this.global.notePainter=this.global.noteCanvas.getContext("2d"),this.global.trackPainter=this.global.trackCanvas.getContext("2d"),this.global.judgePainter=this.global.judgeCanvas.getContext("2d"),this.resize(),window.onresize=function(){return function(){t.resize()}()},document.onkeydown=function(e){e.repeat||(t.global.keyPressTime[e.key.toUpperCase()]=t.global.currentTime,t.global.keyIsHold[e.key.toUpperCase()]=!0,t.global.keyUsed[e.key.toUpperCase()]=!1),"Escape"==e.key&&t.pause(),"Enter"==e.key&&t.continuePlay()},document.onkeyup=function(e){t.global.keyIsHold[e.key.toUpperCase()]=!1},document.addEventListener("gesturestart",(function(t){t.preventDefault()})),this.playInterface.ontouchstart=function(e){if(t.chart.tracks){for(var a=t.global.currentTime,n=[],o=0;o<t.chart.tracks.length;o++){var i=t.chart.tracks[o];a>i.startTiming&&a<i.endTiming&&1==i.type&&n.push(i)}for(var r=0;r<e.touches.length;r++)for(var s=0;s<n.length;s++){i=n[s];var l=e.touches[r],c=(parseFloat(i.tempPositionX)-parseFloat(i.tempWidth))*t.global.screenWidth,u=(parseFloat(i.tempPositionX)+parseFloat(i.tempWidth))*t.global.screenWidth;if(l.pageX>c&&l.pageX<u){var d=i.key.toUpperCase();t.global.keyPressTime[d]=a,t.global.keyIsHold[d]=!0,t.global.keyUsed[d]=!1,t.global.keyMap[l.identifier]=d}}}e.touches.length>1&&e.preventDefault()};var e=0;this.playInterface.ontouchend=function(a){var n=(new Date).getTime();if(n-e<=300&&a.preventDefault(),e=n,t.chart.tracks)for(var o=0;o<a.changedTouches.length;o++){var i=a.changedTouches[o];t.global.keyIsHold[t.global.keyMap[i.identifier]]=!1}},this.initiate()},methods:{resize:function(){var t=this;this.playInterface=document.getElementById("play-interface-container"),t.global.screenWidth=document.documentElement.clientWidth,t.global.screenHeight=document.documentElement.clientHeight,t.global.noteCanvas.height=t.playInterface.offsetHeight,t.global.trackCanvas.height=t.playInterface.offsetHeight,t.global.judgeCanvas.height=t.playInterface.offsetHeight,t.global.noteCanvas.width=t.playInterface.offsetWidth,t.global.trackCanvas.width=t.playInterface.offsetWidth,t.global.judgeCanvas.width=t.playInterface.offsetWidth},initiate:function(){this.getChart()},getChart:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$http.get("/user/getChart?songId=".concat(t.$route.query.songId));case 3:a=e.sent,n=a.data,0!==n.code&&t.$notify({title:"失败",message:"登录失败！",type:"error"}),t.chart=n.data,t.loadingStatus.chart=!0,t.sortTrack(),t.generateImagePath(),e.next=15;break;case 12:return e.prev=12,e.t0=e["catch"](0),e.abrupt("return",t.$notify({title:"错误",message:"网络异常",type:"error"}));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))()},calculateScore:function(){var t=1e7/this.chart.notesCount;this.global.score=Math.floor(this.global.pureCount*t+.5*this.global.farCount*t),this.global.score>1e7&&(this.global.score=1e7)},sortTrack:function(){this.chart.tracks.sort((function(t,e){return t.startTiming-e.startTiming}))},finish:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$http.post("/play/uploadRecord",{score:t.global.score,songId:t.$route.query.songId,pure:t.global.pureCount,far:t.global.farCount,lost:t.global.lostCount,combo:t.global.maxCombo});case 3:a=e.sent,n=a.data,0!==n.code&&t.$notify({title:"失败",message:"成绩上传失败！",type:"error"}),t.global.formerBestScore=n.data.formerBestScore,t.$store.commit("changeParam",{key:"potential",value:n.data.potential}),e.next=13;break;case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",t.$notify({title:"错误",message:"网络异常",type:"error"}));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},run:function(){var t=this;document.documentElement.clientWidth==this.global.screenWidth&&document.documentElement.clientHeight==this.global.screenHeight||this.resize(),this.global.notePainter.clearRect(0,0,this.global.noteCanvas.width,this.global.noteCanvas.height),this.global.trackPainter.clearRect(0,0,this.global.trackCanvas.width,this.global.trackCanvas.height),this.global.judgePainter.clearRect(0,0,this.global.judgeCanvas.width,this.global.judgeCanvas.height),this.global.currentTime=Math.floor(1e3*this.audio.currentTime),this.global.currentTime<this.chart.songLength-150?setTimeout((function(){t.run()}),10):(this.global.currentTime=this.chart.songLength,this.loadingStatus.beforeFinished=!0,this.calculateScore(),this.finish(),this.$forceUpdate(),setTimeout((function(){t.loadingStatus.finished=!0,t.$forceUpdate()}),2e3))},audioLoaded:function(){this.audio=document.getElementById("audioSong"),this.chart.songLength=Math.round(1e3*this.audio.duration),this.generateImagePath(),this.loadingStatus.audio=!0,console.log("audio loaded"),this.checkIfLoaded()},imageLoaded:function(){this.loadingStatus.imageCurrentCount++,this.loadingStatus.imageCurrentCount==this.imagePath.length&&(this.loadingStatus.image=!0,console.log("image loaded"),this.checkIfLoaded())},log:function(t){console.log(t)},startMusic:function(){var t=this;this.loadingStatus.canRun&&(this.audio.play(),this.audio.muted=!0,this.loadingStatus.runReady=!0,this.$forceUpdate(),setTimeout((function(){t.loadingStatus.runStart=!0,t.$forceUpdate(),t.audio.currentTime=0,t.audio.muted=!1,t.audio.volume=t.$store.state.volume/100,t.run()}),500))},generateImagePath:function(){this.imagePath=[];var t=this.chart.changeBackgroundOperations.length,e=0,a=e,n=this.chart.defaultBackground;0==t?a=this.chart.songLength:(this.chart.changeBackgroundOperations.sort((function(t,e){return t.startTime-e.startTime})),a=this.chart.changeBackgroundOperations[0].startTime),this.imagePath.push({url:n,startTime:0,endTime:a});for(var o=0;o<t;o++){var i=this.chart.changeBackgroundOperations[o];if(e=i.startTime,o!=t-1){var r=this.chart.changeBackgroundOperations[o+1];this.imagePath.push({url:i.background,startTime:e,endTime:r.startTime})}else this.imagePath.push({url:i.background,startTime:e,endTime:this.chart.songLength+1e3})}},addCount:function(t){this.global[t.key]+=1,console.log(t.message+", 点击时机:"+t.judgeTime+", 音符时机:"+t.timing),"lost"==t.type?this.global.combo=0:(this.global.combo++,this.global.maxCombo=Math.max(this.global.maxCombo,this.global.combo))},checkIfLoaded:function(){var t=this;this.loadingStatus.chart&&this.loadingStatus.audio&&this.loadingStatus.image&&setTimeout((function(){t.loadingStatus.canRun=!0,t.$forceUpdate()}),1e3)},pause:function(){this.global.currentTime<this.chart.songLength&&(this.audio.pause(),this.pauseVisible=!0)},continuePlay:function(){this.pauseVisible=!1,this.audio.play()},reStart:function(){this.pauseVisible=!1,this.global.keyPressTime=[],this.global.keyIsHold=[],this.global.keyUsed=[],this.global.keyMap=[],this.global.pureCount=0,this.global.farCount=0,this.global.lostCount=0,this.global.combo=0,this.global.maxCombo=0,this.global.score=0,this.resetTrack(),this.audio.currentTime=0,this.audio.play()},resetTrack:function(){this.global.keyPressTime=[],this.global.keyIsHold=[],this.global.keyUsed=[];for(var t=0;t<this.chart.tracks.length;t++){for(var e=this.chart.tracks[t],a=0,n=e.notes.length,o=e.notes.length-1;o>=0;o--)e.notes[o].judged=!1,e.notes[o].timing+this.global.lostTime>this.global.currentTime&&(a=o),this.global.currentTime<e.notes[o].timing-this.global.remainingTime&&(n=o);e.judges=[],e.currentNote=a,e.lastNote=n-1,e.currentNote!=e.notes.length?e.judgeFinished=!1:e.judgeFinished=!0}}}};a("d0c2");const ot=k()(nt,[["render",s],["__scopeId","data-v-d81e6c60"]]);e["default"]=ot},"9a0c":function(t,e,a){var n=a("342f");t.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},a43a:function(t,e,a){"use strict";a("fd28")},d0c2:function(t,e,a){"use strict";a("edd0")},edd0:function(t,e,a){},fd28:function(t,e,a){}}]);
//# sourceMappingURL=chunk-0bfa384c.48d34e50.js.map